{"version":3,"file":"named-register.min.js","sources":["../../src/extras/named-register.js"],"sourcesContent":["/*\r\n * SystemJS named register extension\r\n * Supports System.register('name', [..deps..], function (_export, _context) { ... })\r\n * \r\n * Names are written to the registry as-is\r\n * System.register('x', ...) can be imported as System.import('x')\r\n */\r\n(function (global) {\r\n  var System = global.PentaSystem;\r\n  setRegisterRegistry(System);\r\n  var systemJSPrototype = System.constructor.prototype;\r\n  var constructor = System.constructor;\r\n  var SystemJS = function () {\r\n    constructor.call(this);\r\n    setRegisterRegistry(this);\r\n  };\r\n  SystemJS.prototype = systemJSPrototype;\r\n  System.constructor = SystemJS;\r\n\r\n  var firstNamedDefine, firstName;\r\n\r\n  function setRegisterRegistry(systemInstance) {\r\n    systemInstance.registerRegistry = Object.create(null);\r\n    systemInstance.namedRegisterAliases = Object.create(null);\r\n  }\r\n\r\n  var register = systemJSPrototype.register;\r\n  systemJSPrototype.register = function (name, deps, declare) {\r\n    if (typeof name !== 'string')\r\n      return register.apply(this, arguments);\r\n    var define = [deps, declare];\r\n    this.registerRegistry[name] = define;\r\n    if (!firstNamedDefine) {\r\n      firstNamedDefine = define;\r\n      firstName = name;\r\n    }\r\n    Promise.resolve().then(function () {\r\n      firstNamedDefine = null;\r\n      firstName = null;\r\n    });\r\n    return register.apply(this, [deps, declare]);\r\n  };\r\n\r\n  var resolve = systemJSPrototype.resolve;\r\n  systemJSPrototype.resolve = function (id, parentURL) {\r\n    try {\r\n      // Prefer import map (or other existing) resolution over the registerRegistry\r\n      return resolve.call(this, id, parentURL);\r\n    } catch (err) {\r\n      if (id in this.registerRegistry) {\r\n        return this.namedRegisterAliases[id] || id;\r\n      }\r\n      throw err;\r\n    }\r\n  };\r\n\r\n  var instantiate = systemJSPrototype.instantiate;\r\n  systemJSPrototype.instantiate = function (url, firstParentUrl) {\r\n    var result = this.registerRegistry[url];\r\n    if (result) {\r\n      this.registerRegistry[url] = null;\r\n      return result;\r\n    } else {\r\n      return instantiate.call(this, url, firstParentUrl);\r\n    }\r\n  };\r\n\r\n  var getRegister = systemJSPrototype.getRegister;\r\n  systemJSPrototype.getRegister = function (url) {\r\n    // Calling getRegister() because other extras need to know it was called so they can perform side effects\r\n    var register = getRegister.call(this, url);\r\n\r\n    if (firstName && url) {\r\n      this.namedRegisterAliases[firstName] = url;\r\n    }\r\n    var result = firstNamedDefine || register;\r\n    firstNamedDefine = null;\r\n    firstName = null;\r\n    return result;\r\n  }\r\n})(typeof self !== 'undefined' ? self : global);\r\n"],"names":["global","setRegisterRegistry","systemInstance","registerRegistry","Object","create","namedRegisterAliases","System","PentaSystem","firstNamedDefine","firstName","systemJSPrototype","constructor","prototype","SystemJS","call","this","register","name","deps","declare","apply","arguments","define","Promise","resolve","then","id","parentURL","err","instantiate","url","firstParentUrl","result","getRegister","self"],"mappings":"CAOA,SAAWA,GAcT,SAASC,EAAoBC,GAC3BA,EAAeC,iBAAmBC,OAAOC,OAAO,MAChDH,EAAeI,qBAAuBF,OAAOC,OAAO,MAftD,IAAIE,EAASP,EAAOQ,YACpBP,EAAoBM,GACpB,IASIE,EAAkBC,EATlBC,EAAoBJ,EAAOK,YAAYC,UACvCD,EAAcL,EAAOK,YACrBE,EAAW,WACbF,EAAYG,KAAKC,MACjBf,EAAoBe,OAEtBF,EAASD,UAAYF,EACrBJ,EAAOK,YAAcE,EASrB,IAAIG,EAAWN,EAAkBM,SACjCN,EAAkBM,SAAW,SAAUC,EAAMC,EAAMC,GACjD,GAAoB,iBAATF,EACT,OAAOD,EAASI,MAAML,KAAMM,WAC9B,IAAIC,EAAS,CAACJ,EAAMC,GAUpB,OATAJ,KAAKb,iBAAiBe,GAAQK,EACzBd,IACHA,EAAmBc,EACnBb,EAAYQ,GAEdM,QAAQC,UAAUC,MAAK,WACrBjB,EAAmB,KACnBC,EAAY,QAEPO,EAASI,KAAML,KAAOG,EAAMC,IAGrC,IAAIK,EAAUd,EAAkBc,QAChCd,EAAkBc,QAAU,SAAUE,EAAIC,GACxC,IAEE,OAAOH,EAAQV,KAAKC,KAAMW,EAAIC,GAC9B,MAAOC,GACP,GAAIF,KAAMX,KAAKb,iBACb,OAAOa,KAAKV,qBAAqBqB,IAAOA,EAE1C,MAAME,IAIV,IAAIC,EAAcnB,EAAkBmB,YACpCnB,EAAkBmB,YAAc,SAAUC,EAAKC,GAC7C,IAAIC,EAASjB,KAAKb,iBAAiB4B,GACnC,OAAIE,GACFjB,KAAKb,iBAAiB4B,GAAO,KACtBE,GAEAH,EAAYf,KAAKC,KAAMe,EAAKC,IAIvC,IAAIE,EAAcvB,EAAkBuB,YACpCvB,EAAkBuB,YAAc,SAAUH,GAExC,IAAId,EAAWiB,EAAYnB,KAAKC,KAAMe,GAElCrB,GAAaqB,IACff,KAAKV,qBAAqBI,GAAaqB,GAEzC,IAAIE,EAASxB,GAAoBQ,EAGjC,OAFAR,EAAmB,KACnBC,EAAY,KACLuB,GAvEX,CAyEmB,oBAATE,KAAuBA,KAAOnC"}